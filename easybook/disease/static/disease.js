/*! 2015 Baidu Inc. All Rights Reserved */
define("search/diseases/disease",["search/search"],function(e){var t={};return t.init=function(){e.init();var t=$("#current-area");if(t.text().length>5)t.html(t.text().substr(0,4)+"...");this.lanchTab("#departTab"),this.initTab(),this.moreInfo(),this.sortHospital(),this.select(),this.staticTop(),e.backTop(),$(".search_box").children(".area").children("div").css("display","block"),e.areaEvent(),this.orderTime()},t.select=function(){var t=this;$(".depart-select").delegate("li","click",function(i){var n=i.target;$(n).attr("data-value"),$(n).parents(".select-detail").attr("data-type");if($(n).parents(".select-detail").find("li").each(function(){$(this).removeClass("select-cur")}),$(n).addClass("select-cur"),"hospital"==$(this).parents(".depart-select").attr("data-type"))e.httpGet("/pc/hospital/list",$.extend({},t.getFilterData(),t.hosGetData()),"hospital",$("#hospital-list-ul"),1,$(".hospital-pagers"),t.pageDetail);else if("doctor"==$(this).parents(".depart-select").attr("data-type"))e.httpGet("/pc/doctor/listdata",$.extend({},t.getFilterData(),t.docGetData()),"doctor",$("#doctor-info-list"),1,$(".doctor-pagers"))})},t.initTab=function(){var e=$("#departTab").find(".nav").find(".current").index();if(0==e)$(".nav").find("a").eq(0).click();else if(1==e)$(".nav").find("a").eq(1).click();else if(2==e)$(".nav").find("a").eq(2).click()},t.pageDetail=function(){var e={};return e.pageType="disease",e.diseaseName=$("#disease_name").data("value"),e}(),t.lanchTab=function(t){var i=this,n=$(t),a="current";n.on("click",".hd",function(){var t=$(this).data("tab"),r=$(this).addClass(a).siblings().removeClass(a).end().index();if(n.find(".content").eq(r).show().siblings().hide(),"doctor"==t){if(0==e.docSuccess)e.httpGet("/pc/doctor/listdata",$.extend({},i.getFilterData(),i.docGetData()),"doctor",$("#doctor-info-list"),1,$(".doctor-pagers"))}else if("hospital"==t){if(0==e.hosSuccess)e.httpGet("/pc/hospital/list",$.extend({},i.getFilterData(),i.hosGetData()),"hospital",$("#hospital-list-ul"),1,$(".hospital-pagers"),i.pageDetail);i.pageEvent()}else if("detail"==t){if(0==e.reDocSuccess){var o={};if(o.pageSize=15,""==$("#search-tips-input").attr("data-value")){if(""!=$(".disease-depart").attr("data-depart1"))o.departLevel1Id=$(".disease-depart").attr("data-depart1");if(""!=$(".disease-depart").attr("data-depart2"))o.departLevel2Id=$(".disease-depart").attr("data-depart2")}e.httpGet("/pc/doctor/listdata",$.extend({},i.getFilterData(),o),"relativeDoc",$("#excel-doctor-div"),1,"","",5)}if(0==e.reHosSuccess)e.httpGet("/pc/hospital/list",$.extend({},i.getFilterData(),{pageSize:8}),"relativeHos",$("#excel-hos-div"),1)}if($(".nav").hasClass("static-top"))$(window).scrollTop(i.scroll),n.find(".content").eq(r).css("margin-top","58px")})},t.moreInfo=function(){$(".more-hos").click(function(){if("doctor"==$(this).attr("data-type"))$(".nav").find("a").eq(2).click();else if("hospital"==$(this).attr("data-type"))$(".nav").find("a").eq(1).click()})},t.staticTop=function(){var e=this,t=e.scroll;$(window).load(function(){var i=$(this).scrollTop();if(i>=t)$(window).scrollTop(e.scroll-10),$(".nav").addClass("static-top");else if(t>i)$(".header").show(),$(".index-title").show(),$(".depart-title").show(),$(".nav").removeClass("static-top"),$(".content").css("margin-top","10px")}),$(window).scroll(function(){var e=$(this).scrollTop();if($(".nav").hasClass("static-top")){var i=$(".nav").find(".current").index();if(e<$(".main").find(".content").eq(i).attr("data-margin"))$(".content").css("margin-top",e+"px")}if(!$(".nav").hasClass("static-top")&&e>=t)$(".nav").addClass("static-top");else if($(".nav").hasClass("static-top")&&t>e)$(".header").show(),$(".index-title").show(),$(".depart-title").show(),$(".nav").removeClass("static-top"),$(".content").css("margin-top","10px")})},t.sortHospital=function(){var t=this;$(".hospital-sort").delegate("span","click",function(i){var n=i.target;if(1==$(this).index())$(this).html("预约量从高到低"),$(this).addClass("sort-cur").siblings("span").removeClass("sort-cur");else if(0==$(this).index())$(".hospital-sort").find("span").eq(1).html("预约量"),$(this).addClass("sort-cur").siblings("span").removeClass("sort-cur");else if(2==$(this).index())if(n.innerHTML==$(".medical-care").attr("data-value"))if(1==$(this).find("input")[0].checked)$(this).find("input")[0].checked=!1;else $(this).find("input")[0].checked=!0;e.httpGet("/pc/hospital/list",$.extend({},t.getFilterData(),t.hosGetData()),"hospital",$("#hospital-list-ul"),1,$(".hospital-pagers"),t.pageDetail)})},t.pageEvent=function(){$(".pagination-x-list").find("li").length;$(".pagination-x-list").delegate("li","click",function(){if(0!==$(this).index()||$(this).index()!==$(".pagination-x-list").find("li").last().index())$("#fastTop").show()})},t.getFilterData=function(){var e={};if(1==$("#current-area").attr("data-provTag"))e.provId=$("#current-area").attr("data-provId");else e.cityId=$("#city-list").find(".current-select").attr("data-value"),e.provId=$("#city-list").find(".current-select").attr("data-provId");return e.key=$("#disease_name").attr("data-value"),e.regionId="",e.key="undefined"!=typeof e.key?e.key:"",e.provId="undefined"!=typeof e.provId?e.provId:"",e.cityId="undefined"!=typeof e.cityId?e.cityId:"",e},t.hosGetData=function(){var e={};if(e.pageSize=10,e.hospitalType=$(".hospital-type").find(".select-cur").attr("data-value"),e.hospitalLvl=$(".hospital-level").find(".select-cur").attr("data-value"),"region"==$("#region").attr("data-place"))e.regionId=$("#region").find(".select-cur").attr("data-value");else if("city"==$("#region").attr("data-place"))e.cityId=$("#region").find(".select-cur").attr("data-value");return e.sortType=$(".hospital-sort").find(".sort-cur").attr("data-value"),e.isInsurance=$(".hospital-sort").find("input").length>0?1==$(".hospital-sort").find("input")[0].checked?1:0:"",e.hospitalType="undefined"!=typeof e.hospitalType?e.hospitalType:"",e.hospitalLvl="undefined"!=typeof e.hospitalLvl?e.hospitalLvl:"",e.regionId="undefined"!=typeof e.regionId?e.regionId:"",e.sortType="undefined"!=typeof e.sortType?e.sortType:"",e.isInsurance="undefined"!=typeof e.isInsurance?e.isInsurance:"",e},t.docGetData=function(){var e={};if(e.pageSize=10,""==$("#search-tips-input").attr("data-value")){if(""!=$(".disease-depart").attr("data-depart1"))e.departLevel1Id=$(".disease-depart").attr("data-depart1");if(""!=$(".disease-depart").attr("data-depart2"))e.departLevel2Id=$(".disease-depart").attr("data-depart2")}return e.date=$("#select-visit-time").find(".select-cur").attr("data-value"),e.date="undefined"!=typeof e.date?e.date:"",e.medTitle=$("#medtitle-ul").find(".select-cur").attr("data-value"),e.medTitle="undefined"!=typeof e.medTitle?e.medTitle:"",e},t.orderTime=function(){var t=this;$(".doctor-order-time").on("click",function(){$(".visit-hover").toggle()}),$(".doctor-visit-ul").delegate("li","click",function(i){var n=$(this);if(i.stopPropagation(),n.is(".date-group"))return i.preventDefault(),!0;if(n.is(".date-classify")||n.is(".date-unit")){$(".doctor-visit-ul").find("li").removeClass("select-cur");var a=$(i.currentTarget);a.addClass("select-cur"),$(".visit-hover").hide(),e.httpGet("/pc/doctor/listdata",$.extend({},t.getFilterData(),t.docGetData()),"doctor",$("#doctor-info-list"),1,$(".doctor-pagers"))}}),$("#icon-order-time").hover(function(){},function(){$(".visit-hover").hide()})},t});